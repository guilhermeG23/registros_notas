"use strict";!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery||Zepto)}(function(l){var c=function(i,g,m){var M={invalid:[],getCaret:function(){try{var t,a=0,e=i.get(0),n=document.selection,r=e.selectionStart;return n&&-1===navigator.appVersion.indexOf("MSIE 10")?((t=n.createRange()).moveStart("character",-M.val().length),a=t.text.length):(r||"0"===r)&&(a=r),a}catch(t){}},setCaret:function(t){try{if(i.is(":focus")){var a,e=i.get(0);e.setSelectionRange?(e.focus(),e.setSelectionRange(t,t)):((a=e.createTextRange()).collapse(!0),a.moveEnd("character",t),a.moveStart("character",t),a.select())}}catch(t){}},events:function(){i.on("keydown.mask",function(t){i.data("mask-keycode",t.keyCode||t.which)}).on(l.jMaskGlobals.useInput?"input.mask":"keyup.mask",M.behaviour).on("paste.mask drop.mask",function(){setTimeout(function(){i.keydown().keyup()},100)}).on("change.mask",function(){i.data("changed",!0)}).on("blur.mask",function(){s===M.val()||i.data("changed")||i.trigger("change"),i.data("changed",!1)}).on("blur.mask",function(){s=M.val()}).on("focus.mask",function(t){!0===m.selectOnFocus&&l(t.target).select()}).on("focusout.mask",function(){m.clearIfNotMatch&&!e.test(M.val())&&M.val("")})},getRegexMask:function(){for(var t,a,e,n,r,s,o=[],c=0;c<g.length;c++)(t=y.translation[g.charAt(c)])?(a=t.pattern.toString().replace(/.{1}$|^.{1}/g,""),e=t.optional,(n=t.recursive)?(o.push(g.charAt(c)),r={digit:g.charAt(c),pattern:a}):o.push(e||n?a+"?":a)):o.push(g.charAt(c).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"));return s=o.join(""),r&&(s=s.replace(new RegExp("("+r.digit+"(.*"+r.digit+")?)"),"($1)?").replace(new RegExp(r.digit,"g"),r.pattern)),new RegExp(s)},destroyEvents:function(){i.off(["input","keydown","keyup","paste","drop","blur","focusout",""].join(".mask "))},val:function(t){var a,e=i.is("input")?"val":"text";return 0<arguments.length?(i[e]()!==t&&i[e](t),a=i):a=i[e](),a},getMCharsBeforeCount:function(t,a){for(var e=0,n=0,r=g.length;n<r&&n<t;n++)y.translation[g.charAt(n)]||(t=a?t+1:t,e++);return e},caretPos:function(t,a,e,n){return y.translation[g.charAt(Math.min(t-1,g.length-1))]?Math.min(t+e-a-n,e):M.caretPos(t+1,a,e,n)},behaviour:function(t){t=t||window.event,M.invalid=[];var a=i.data("mask-keycode");if(-1===l.inArray(a,y.byPassKeys)){var e=M.getCaret(),n=M.val().length,r=M.getMasked(),s=r.length,o=M.getMCharsBeforeCount(s-1)-M.getMCharsBeforeCount(n-1),c=e<n;return M.val(r),c&&(8!==a&&46!==a&&(e=M.caretPos(e,n,s,o)),M.setCaret(e)),M.callbacks(t)}},getMasked:function(t,a){var e,n,r=[],s=void 0===a?M.val():a+"",o=0,c=g.length,i=0,l=s.length,u=1,f="push",h=-1;for(m.reverse?(f="unshift",u=-1,e=0,o=c-1,i=l-1,n=function(){return-1<o&&-1<i}):(e=c-1,n=function(){return o<c&&i<l});n();){var k=g.charAt(o),d=s.charAt(i),v=y.translation[k];v?(d.match(v.pattern)?(r[f](d),v.recursive&&(-1===h?h=o:o===e&&(o=h-u),e===h&&(o-=u)),o+=u):v.optional?(o+=u,i-=u):v.fallback?(r[f](v.fallback),o+=u,i-=u):M.invalid.push({p:i,v:d,e:v.pattern}),i+=u):(t||r[f](k),d===k&&(i+=u),o+=u)}var p=g.charAt(e);return c!==l+1||y.translation[p]||r.push(p),r.join("")},callbacks:function(t){var a=M.val(),e=a!==s,n=[a,t,i,m],r=function(t,a,e){"function"==typeof m[t]&&a&&m[t].apply(this,e)};r("onChange",!0===e,n),r("onKeyPress",!0===e,n),r("onComplete",a.length===g.length,n),r("onInvalid",0<M.invalid.length,[a,t,i,M.invalid,m])}};i=l(i);var e,y=this,s=M.val();g="function"==typeof g?g(M.val(),void 0,i,m):g,y.mask=g,y.options=m,y.remove=function(){var t=M.getCaret();return M.destroyEvents(),M.val(y.getCleanVal()),M.setCaret(t-M.getMCharsBeforeCount(t)),i},y.getCleanVal=function(){return M.getMasked(!0)},y.getMaskedVal=function(t){return M.getMasked(!1,t)},y.init=function(t){if(t=t||!1,m=m||{},y.clearIfNotMatch=l.jMaskGlobals.clearIfNotMatch,y.byPassKeys=l.jMaskGlobals.byPassKeys,y.translation=l.extend({},l.jMaskGlobals.translation,m.translation),y=l.extend(!0,{},y,m),e=M.getRegexMask(),!1===t){m.placeholder&&i.attr("placeholder",m.placeholder),i.data("mask")&&i.attr("autocomplete","off"),M.destroyEvents(),M.events();var a=M.getCaret();M.val(M.getMasked()),M.setCaret(a+M.getMCharsBeforeCount(a,!0))}else M.events(),M.val(M.getMasked())},y.init(!i.is("input"))};l.maskWatchers={};var a=function(){var t=l(this),a={},e="data-mask-",n=t.attr("data-mask");if(t.attr(e+"reverse")&&(a.reverse=!0),t.attr(e+"clearifnotmatch")&&(a.clearIfNotMatch=!0),"true"===t.attr(e+"selectonfocus")&&(a.selectOnFocus=!0),i(t,n,a))return t.data("mask",new c(this,n,a))},i=function(t,a,e){e=e||{};var n=l(t).data("mask"),r=JSON.stringify,s=l(t).val()||l(t).text();try{return"function"==typeof a&&(a=a(s)),"object"!=typeof n||r(n.options)!==r(e)||n.mask!==a}catch(t){}};l.fn.mask=function(t,a){a=a||{};var e=this.selector,n=l.jMaskGlobals,r=n.watchInterval,s=a.watchInputs||n.watchInputs,o=function(){if(i(this,t,a))return l(this).data("mask",new c(this,t,a))};return l(this).each(o),e&&""!==e&&s&&(clearInterval(l.maskWatchers[e]),l.maskWatchers[e]=setInterval(function(){l(document).find(e).each(o)},r)),this},l.fn.masked=function(t){return this.data("mask").getMaskedVal(t)},l.fn.unmask=function(){return clearInterval(l.maskWatchers[this.selector]),delete l.maskWatchers[this.selector],this.each(function(){var t=l(this).data("mask");t&&t.remove().removeData("mask")})},l.fn.cleanVal=function(){return this.data("mask").getCleanVal()},l.applyDataMask=function(t){((t=t||l.jMaskGlobals.maskElements)instanceof l?t:l(t)).filter(l.jMaskGlobals.dataMaskAttr).each(a)};var t,e,n,r={maskElements:"input,td,span,div",dataMaskAttr:"*[data-mask]",dataMask:!0,watchInterval:300,watchInputs:!0,useInput:(t="input",n=document.createElement("div"),(e=(t="on"+t)in n)||(n.setAttribute(t,"return;"),e="function"==typeof n[t]),n=null,e),watchDataMask:!1,byPassKeys:[9,16,17,18,36,37,38,39,40,91],translation:{0:{pattern:/\d/},9:{pattern:/\d/,optional:!0},"#":{pattern:/\d/,recursive:!0},A:{pattern:/[a-zA-Z0-9]/},S:{pattern:/[a-zA-Z]/}}};l.jMaskGlobals=l.jMaskGlobals||{},(r=l.jMaskGlobals=l.extend(!0,{},r,l.jMaskGlobals)).dataMask&&l.applyDataMask(),setInterval(function(){l.jMaskGlobals.watchDataMask&&l.applyDataMask()},r.watchInterval)});
